/*attackGoal(execCode(webServer,_)).*/
/*attackGoal(dos(scada)).*/
/*attackGoal(accessInfo(scada)).*/
attackGoal(covertAppropriation(plc)).

attackerLocated(internet).
inCompetent(alarmProvider).
hasAccount(alarmProvider,webServer,root).

hacl(internet,webServer,ipSec,80).
networkServiceInfo(webServer,vpnservice,ipSec,80,_).

hacl(webServer,scada,_,_).
hacl(plc,scada,opcua,opcua_port).
/*hacl(scada,plc,modbus_tcp,modbus_port).*/
hacl(scada,plc,opcua,opcua_port).
/*hacl(scada,plc,ethernet_ip,ethernet_port).*/

hacl(webServer,database,_,_).

isSensor(sensor).
/*hacl(sensor,plc,modbus_tcp,modbus_port).*/
hacl(sensor, plc, opcua, opcua_port).
canSniffCommunication(sensor,plc).

isActuator(actuator).
canSniffCommunication(plc,actuator).

malicious(technician).
physicalAccess(technician,sensor).
physicalAccess(technician,actuator).

/*hacl(plc,actuator,modbus_tcp,modbus_port).*/
hacl(plc,actuator,opcua,opcua_port).

networkServiceInfo(plc,controlExpert,opcua,opcua_port,_).
networkServiceInfo(scada,machineExpert,_,400,_).
networkServiceInfo(scada,opcua_server,opcua,opcua_port,_).

vulExists(scada,'CVE-2023-22610',machineExpert).
vulProperty('CVE-2023-22610',hijackcomm,dos).
cvss('CVE-2023-22610',h).

vulExists(scada,'CVE-2022-2988',machineExpert).
vulProperty('CVE-2022-2988',webAccess,leakinfo).
cvss('CVE-2022-2988',h).

vulExists(scada,'CVE-2023-22611',machineExpert).
vulProperty('CVE-2023-22611',hijackcomm,leakinfo).
cvss('CVE-2023-22611',likely).

vulExists(plc,'CVE-2022-45789',controlExpert).
vulProperty('CVE-2022-45789',localExploit,privEscalation).
vulProperty('CVE-2022-45789',hijackcomm,authenticationBypass).
cvss('CVE-2022-45789',h).

vulExists(plc,'CVE-2022-45788',controlExpert).
vulProperty('CVE-2022-45788',localExploit,privEscalation).
vulProperty('CVE-2022-45788',codeExecution,dos).
vulProperty('CVE-2022-45788',codeExecution,leakinfo).
cvss('CVE-2022-45788',h).

vulExists(plc,'CVE-2021-22789',controlExpert).
vulProperty('CVE-2021-22789',loadFile,dos).
cvss('CVE-2021-22789',m).

vulExists(plc,'CVE-2023-1548',controlExpert).
vulProperty('CVE-2023-1548',codeExecution,dos).
cvss('CVE-2023-1548',m).

vulExists(plc,'CVE-2023-27976',controlExpert).
vulProperty('CVE-2023-27976',codeExecution,privEscalation).
vulProperty('CVE-2023-27976',webAccess,remoteExploit).
cvss('CVE-2023-27976',h).

vulExists(plc,'CVE-2022-37300',controlExpert).
vulProperty('CVE-2022-37300',hijackcomm,authenticationBypass).
cvss('CVE-2022-37300',h).

vulExists(scada,'CVE-2023-37200',opcua_server).
vulProperty('CVE-2023-37200',codeExecution,leakinfo).
cvss('CVE-2023-37200',m).