attackGoal(execCode(workingStation,_)).
inSubnet(webServer,local).
inSubnet(workingStation,local).
inSubnet(fileServer,local).
attackerLocated(internet).
localFileProtection(webServer,root,_,_).
hasAccount(apache,webServer,apache).
networkServiceInfo(webServer,httpd,tcp,80,apache).
hacl(internet,webServer,tcp,80).
hacl(webServer,fileServer,nfsProtocol,nfsPort).
hacl(webServer,fileServer,rpc,100005).
hacl(webServer,webServer,tcp,80).
installed(webServer,httpd).
vulExists(webServer,'CAN-2002-0392',httpd,remoteExploit,privEscalation).
localFileProtection(workingStation,root,_,_).
hasAccount(_,workingStation,_).
nfsMounted(workingStation,'/usr/local/share',fileServer,'/export',read).
hasAccount(unprivileged,workingStation,unprivileged).
nfsMounted(workingStation,'/usr/local/share',fileServer,'/export',read).
hacl(workingStation,webServer,tcp,80).
hacl(workingStation,fileServer,rpc,100005).
hacl(workingStation,fileServer,nfsProtocol,nfsPort).
installed(workingStation,nfsmountd).
localFileProtection(fileServer,root,_,_).
hasAccount(root,fileServer,root).
networkServiceInfo(fileServer,mountd,rpc,100005,root).
nfsExportInfo(fileServer,'/export',read,workingStation).
nfsExportInfo(fileServer,'/toto',read,workingStation).
hacl(fileServer,webServer,tcp,80).
hacl(fileServer,fileServer,rpc,100005).
installed(fileServer,mountd).
vulExists(fileServer,'vulID',mountd,remoteExploit,privEscalation).
